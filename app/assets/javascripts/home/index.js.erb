function LoadMe() {
  // The Browser API key obtained from the Google API Console.
  var developerKey = "<%= ENV['GOOGLE_API_KEY'] %>";

  // The Client ID obtained from the Google API Console. Replace with your own Client ID.
  var clientId = "<%= ENV['GOOGLE_CLIENT_ID'] %>"

  // Scope to use to access user's photos.
  var scope = 'https://www.googleapis.com/auth/drive';

  var pickerApiLoaded = false;
  var oauthToken;

  // Use the API Loader script to load google.picker and gapi.auth.
  function onApiLoad() {
    gapi.load('auth2', onAuthApiLoad);
    gapi.load('picker', onPickerApiLoad);
  }

  function onAuthApiLoad() {
    var authBtn = document.getElementById('auth');
    authBtn.disabled = false;
    authBtn.addEventListener('click', function() {
      gapi.auth2.authorize({
        client_id: clientId,
        scope: scope
      }, handleAuthResult);
    });
  }

  function onPickerApiLoad() {
    pickerApiLoaded = true;
    createPicker();
  }

  function handleAuthResult(authResult) {
    if (authResult && !authResult.error) {
      oauthToken = authResult.access_token;
      saveToken(oauthToken);
    }
  }

  function saveToken(oauthToken) {
    var authBtn = document.getElementById('auth');
    $.ajax({
      url: '/api/bots/' + authBtn.dataset.botId,
      type: 'PUT',
      data: 'google_access_token=' + oauthToken,
      success: function(data) {
        createPicker();
      }
    });
  }

  // Create and render a Picker object for picking user Photos.
  function createPicker() {
    if (pickerApiLoaded && oauthToken) {
      var picker = new google.picker.PickerBuilder().
          addView(google.picker.ViewId.SPREADSHEETS).
          setOAuthToken(oauthToken).
          setDeveloperKey(developerKey).
          setCallback(pickerCallback).
          build();
      picker.setVisible(true);
    }
  }

  // A simple callback implementation.
  function pickerCallback(data) {
    // var url = 'nothing';
    if (data[google.picker.Response.ACTION] == google.picker.Action.PICKED) {
      var doc = data[google.picker.Response.DOCUMENTS][0];
      // url = doc[google.picker.Document.URL];
      saveSpreadsheetKey(doc.id, doc.name);
      renderTitle(doc.name);
    }
    // var message = 'You picked: ' + url;
    // document.getElementById('result').innerHTML = message;
  }

  function renderTitle(title) {
    $('.title').html(title)
  }

  function saveSpreadsheetKey(key, title) {
    var authBtn = document.getElementById('auth');
    $.ajax({
      url: '/api/bots/' + authBtn.dataset.botId,
      type: 'PUT',
      data: 'google_spreadsheet_key=' + key + '&google_spreadsheet_title=' + title,
      success: function(data) {

      }
    });
  }

  onApiLoad();
}
